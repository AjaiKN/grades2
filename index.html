<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <title>Grades</title>
  <!-- <link rel="stylesheet" href="whatever-you-want.css"> -->
  <link rel="stylesheet" href="css/styles.css?v=1.0">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="main.js"></script>
</head>

<body>
  <div id="elm"></div>
  <div id="plot" style="width:600px;height:400px;"></div>
  <script>
    var app = Elm.Main.init({
      node: document.getElementById('elm')
    });
    
    const END = 120;
    const STEP = .1;
    function makeGraph(tuple) {
      const currentGrade = tuple[0];
      const assignmentPercent = tuple[1];
      function fun(assignmentGrade) {
        return (currentGrade * (1 - assignmentPercent / 100)) + assignmentGrade * assignmentPercent / 100;
      }

      let plotDiv = document.getElementById('plot');
      
      const x = new Array(END / STEP).fill(undefined).map((val, index) => index * STEP);
      const y = x.map(fun);
      
      Plotly.newPlot(plotDiv, [{
        x: x,
        y: y,
        mode: 'lines'
      }], {
        margin: { t: 0 },
        xaxis: { title: "Assignment grade (%)", dtick: 10, showspikes: true },
        yaxis: { title: "Total grade", dtick: 10, showspikes: true }
      });
    }

    app.ports.plot.subscribe(makeGraph);
  </script>
</body>
</html>